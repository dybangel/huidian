function changeFrom(t){if(!user_input&&"toutiao"===window.default_action){var e=t.value,a="search_tab";gaevent("search","click",""),/^#.*#$/.test(e)&&(a="tag"),$("[name=from]").val(a),user_input=!0}}function sendSearchEvent(t){addStep(),/baidu|shenma/.test(t.action)&&gaevent("event","search","search_tab_baidu")}function baiduHotWordsClick(t){var e=$(t.target);if(e.is("a")){var a=e.attr("href");gaevent("event","search","baidu_hot_word"),setTimeout(function(){location.href=a},400)}}function shenmaHotWordsClick(t){var e=$(t.target);if(e.is("a")){var a=e.attr("href");gaevent("event","search","shenma_hot_word"),setTimeout(function(){location.href=a},400)}}function getBaiduHotWords(){$.get("/baidu_top_words/").done(function(t){t=JSON.parse(t),t.data.forEach(function(t){$(".hot_words .baidu").append("<li><a href='http://m.baidu.com/s?from=1007976a&word="+t.title+"'>"+t.title+"</a></li>")})})}function highlight(){$(".list_content [highlight]").each(function(){for(var t,e=$(this),a=e.attr("highlight"),o=a?JSON.parse(a):[],r=e.text();o.length;){var i=o.pop(),n=i[0],c=i[1];t&&n+c>t||(t=n,r=r.substr(0,n)+"<highlight>"+r.substr(n,c)+"</highlight>"+r.substr(n+c))}e.html(r).removeAttr("highlight")})}function chooseAction(t,e,a){var o={baidu:"http://m.baidu.com/s",toutiao:"/search/",shenma:"http://m.yz.sm.cn/s"},r={baidu:"1007976a",toutiao:a,shenma:"100041"},i={baidu:"word",toutiao:"keyword",shenma:"q"};t&&(window.default_action=t,$(".action_chooser").attr("class","action_chooser action_"+t),$("#search_form").attr("action",o[t]),$("#search_form #from").val(r[t]),$("#search_form #search_input").attr("name",i[t]).focus(),$.cookie("defaultSearchAction",t,{expires:6048e5,path:"/",domain:"toutiao.com"}),$(".hot_words ul."+t).show().siblings().hide()),e||$(".action-navigation, .backdrop").toggleClass("active")}function getSeachContent(t){if(t){search_params.keyword=t;var e={list_content:".list_content",list_bottom:".list_bottom",url:search_url,param:search_params,after_flow:function(){$(".time").timeago({relative:!0}),highlight()},cache:!1},a=navigator.userAgent;a.indexOf("ArticleStreamSdk")>-1&&(e.onArticleClick=function(t,e,a){t.preventDefault(),$(".sslocal").remove();var o="http://m.toutiao.com"+a,r=document.createElement("iframe");r.style.display="none",r.src="sslocal://detail?groupid="+e+"&url="+o,$(r).addClass("sslocal"),$(document.body).append(r)}),indexFlow=new Flow(e)}}function getStep(){var t=1;try{t=localStorage.getItem(searchStepKey)||1}catch(e){}return t}function addStep(){var t=getStep()-0;try{localStorage.setItem(searchStepKey,t+1)}catch(e){}}function resetStep(){try{localStorage.removeItem(searchStepKey)}catch(t){}}var searchStepKey="tt_search_step_key";$(".back.btn").on("click",function(t){var e=getStep()-0;resetStep(),t.preventDefault(),t.stopPropagation(),history.go(-1*e)}),document.body.addEventListener("click",function(t){var e=$(t.target);if("A"==t.target.tagName||e.parents("a").length){"A"!=t.target.tagName&&(e=e.parents("a"));var a=e.attr("href");-1!=a.indexOf("m.toutiao.com/search/")&&addStep()}},!0);